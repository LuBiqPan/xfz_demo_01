function FrontBase(){}function getCookie(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var o=jQuery.trim(n[a]);if(o.substring(0,t.length+1)===t+"="){e=decodeURIComponent(o.substring(t.length+1));break}}return e}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})};var myajax={get:function(t){t.method="get",this.ajax(t)},post:function(t){t.method="post",this._ajaxSetup(),this.ajax(t)},ajax:function(t){$.ajax(t)},_ajaxSetup:function(){$.ajaxSetup({beforeSend:function(t,e){/^(GET|HEAD|OPTIONS|TRACE)$/.test(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",getCookie("csrftoken"))}})}};function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenSignupEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),a=$(".close-btn");e.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),a.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:"0"}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var t=$(".signin-group"),o=t.find("input[name='telephone']"),s=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(t){t.preventDefault();var e=o.val(),n=s.val(),a=i.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:e,password:n,remember:a?1:0,csrfmiddlewaretoken:$("#csrf_token").val()},success:function(t){window.location.reload()}})})},Auth.prototype.listenSignupEvent=function(){var f=$(".signup-group");f.find(".submit-btn").click(function(t){t.preventDefault();var e=f.find("input[name='telephone']"),n=f.find("input[name='username']"),a=f.find("input[name='img_captcha']"),o=f.find("input[name='password1']"),s=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),c=e.val(),r=n.val(),p=a.val(),u=o.val(),l=s.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200===t.code&&window.location.reload()},fail:function(t){window.messageBox.showError("Server internal error.")}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功"),t.smsCaptcha.addClass("disabled");var e=30;t.smsCaptcha.unbind("click");var n=setInterval(function(){t.smsCaptcha.text(e+"s"),--e<=0&&(clearInterval(n),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var e=this,t=$(".sms-captcha-btn"),n=$(".signup-group input[name='telephone']");t.click(function(){var t=n.val();t||messageBox.showInfo("Please type a telephone number."),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&e.smsSuccessEvent()},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){template&&(template.defaults.imports.timeSince=function(t){var e=new Date(t),n=e.getTime(),a=((new Date).getTime()-n)/1e3;return a<60?"刚刚":60<=a&&a<3600?parseInt(a/60)+"分钟前":3600<=a&&a<86400?parseInt(a/60/60)+"小时前":86400<=a&&a<2592e3?parseInt(a/60/60/24)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+": "+e.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiZ2V0Q29va2llIiwibmFtZSIsImNvb2tpZVZhbHVlIiwiZG9jdW1lbnQiLCJjb29raWUiLCJjb29raWVzIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwialF1ZXJ5IiwidHJpbSIsInN1YnN0cmluZyIsImRlY29kZVVSSUNvbXBvbmVudCIsInByb3RvdHlwZSIsInJ1biIsInRoaXMiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwiJCIsInVzZXJNb3JlQm94IiwiaG92ZXIiLCJzaG93IiwiaGlkZSIsIm15YWpheCIsImdldCIsImFyZ3MiLCJhamF4IiwicG9zdCIsIl9hamF4U2V0dXAiLCJhamF4U2V0dXAiLCJiZWZvcmVTZW5kIiwieGhyIiwic2V0dGluZ3MiLCJ0ZXN0IiwidHlwZSIsImNyb3NzRG9tYWluIiwic2V0UmVxdWVzdEhlYWRlciIsIkF1dGgiLCJzZWxmIiwibWFza1dyYXBwZXIiLCJzY3JvbGxXcmFwcGVyIiwic21zQ2FwdGNoYSIsImxpc3RlblNob3dIaWRlRXZlbnQiLCJsaXN0ZW5Td2l0Y2hFdmVudCIsImxpc3RlblNpZ25pbkV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJsaXN0ZW5JbWdDYXB0Y2hhRXZlbnQiLCJsaXN0ZW5TbXNDYXB0Y2hhRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsImN1cnJlbnRMZWZ0IiwicGFyc2VJbnQiLCJhbmltYXRlIiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsInhmemFqYXgiLCJ1cmwiLCJkYXRhIiwiY3NyZm1pZGRsZXdhcmV0b2tlbiIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsInNpZ251cEdyb3VwIiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsImltZ0NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJpbWdfY2FwdGNoYSIsInNtc19jYXB0Y2hhIiwiY29kZSIsImZhaWwiLCJlcnJvciIsIm1lc3NhZ2VCb3giLCJzaG93RXJyb3IiLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsInNtc1N1Y2Nlc3NFdmVudCIsInNob3dTdWNjZXNzIiwiYWRkQ2xhc3MiLCJjb3VudCIsInVuYmluZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwic2hvd0luZm8iLCJjb25zb2xlIiwibG9nIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lU3RhbXAiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF5IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIl0sIm1hcHBpbmdzIjoiQUFDQSxTQUFTQSxhQTBEVCxTQUFTQyxVQUFVQyxHQUNmLElBQUlDLEVBQWMsS0FDbEIsR0FBSUMsU0FBU0MsUUFBOEIsS0FBcEJELFNBQVNDLE9BRTVCLElBREEsSUFBSUMsRUFBVUYsU0FBU0MsT0FBT0UsTUFBTSxLQUMzQkMsRUFBSSxFQUFHQSxFQUFJRixFQUFRRyxPQUFRRCxJQUFLLENBQ3JDLElBQUlILEVBQVNLLE9BQU9DLEtBQUtMLEVBQVFFLElBRWpDLEdBQUlILEVBQU9PLFVBQVUsRUFBR1YsRUFBS08sT0FBUyxLQUFRUCxFQUFPLElBQU0sQ0FDdkRDLEVBQWNVLG1C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QkFFVixNQUdQVixLQUFLeEIsVUFBVWtDLHNCQUF3QixXQUNuQyxJQUFJVCxFQUFPdkIsS0FDUDBCLEVBQWF2QixFQUFFLG9CQUNmMEMsRUFBaUIxQyxFQUFFLHlDQUN2QnVCLEVBQVdZLE1BQU0sV0FDYixJQUFJYSxFQUFZTixFQUFlTyxNQUMxQkQsR0FDRDZCLFdBQVdlLFNBQVMsbUNBRXhCdkMsUUFBUS9DLElBQUksQ0FDUmdELElBQU8sd0JBQ1BDLEtBQVEsQ0FDSlAsVUFBY0EsR0FFbEJTLFFBQVcsU0FBVUMsR0FDSyxLQUFsQkEsRUFBYSxNQUNidEMsRUFBSzhELG1CQUdiUCxLQUFRLFNBQVVDLEdBQ2RpQixRQUFRQyxJQUFJbEIsU0FNNUI1RSxFQUFFLFlBQ1ksSUFBSW1CLE1BQ1Z2QixRQUlSSSxFQUFFLFlBQ2tCLElBQUluQixXQUNWZSxRQUlkSSxFQUFFLFdBQ0srRixXQUNDQSxTQUFTQyxTQUFTQyxRQUFRQyxVQUFZLFNBQVVDLEdBQzVDLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQVNGLEVBQUtHLFVBRWRDLElBRFEsSUFBS0gsTUFBUUUsVUFDQUQsR0FBVSxJQUVuQyxPQUFJRSxFQUFZLEdBQ0wsS0FDYSxJQUFiQSxHQUFtQkEsRUFBWSxLQUN4QmpFLFNBQVNpRSxFQUFVLElBQ2YsTUFDRSxNQUFiQSxHQUFzQkEsRUFBWSxNQUM3QmpFLFNBQVNpRSxFQUFVLEdBQUcsSUFDbkIsTUFDTSxPQUFiQSxHQUF5QkEsRUFBWSxPQUNsQ2pFLFNBQVNpRSxFQUFVLEdBQUcsR0FBRyxJQUN0QixLQUVISixFQUFLSyxjQUtGLElBSkZMLEVBQUtNLFdBSVcsSUFIbEJOLEVBQUtPLFNBR3lCLElBRjdCUCxFQUFLUSxXQUVxQyxLQUR4Q1IsRUFBS1MiLCJmaWxlIjoiZnJvbnRfYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZnVuY3Rpb24gRnJvbnRCYXNlKCkge1xyXG4gICAgXHJcbn1cclxuXHJcbkZyb250QmFzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHNlbGYubGlzdGVuQXV0aEJveEhvdmVyKCk7XHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoQm94ID0gJChcIi5hdXRoLWJveFwiKTtcclxuICAgIHZhciB1c2VyTW9yZUJveCA9ICQoXCIudXNlci1tb3JlLWJveFwiKTtcclxuXHJcbiAgICBhdXRoQm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5zaG93KCk7XHJcbiAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guaGlkZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8gT3BlbiAvIGNsb3NlIGxvZ2luIHBhZ2UuXHJcbi8vICQoZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgLy8gQ2xpY2sgb24gbG9naW4gYnV0dG9uLlxyXG4vLyAgICAgJChcIiNidG5cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgICQoXCIubWFzay13cmFwcGVyXCIpLnNob3coKTtcclxuLy8gICAgIH0pO1xyXG4vL1xyXG4vLyAgICAgLy8gQ2xpY2sgb24gY2xvc2UgYnV0dG9uLlxyXG4vLyAgICAgJChcIi5jbG9zZS1idG5cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgICQoXCIubWFzay13cmFwcGVyXCIpLmhpZGUoKTtcclxuLy8gICAgIH0pO1xyXG4vLyB9KTtcclxuXHJcblxyXG4vLyBMb2dpbiAvIHJlZ2lzdGVyIHN3aXRjaC5cclxuLy8gJChmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAkKFwiLnN3aXRjaFwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgdmFyIHNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4vLyAgICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuLy8gICAgICAgICAvLyBcImxlZnQ6IDEwcHhcIiAtPiBcIjEwXCIuXHJcbi8vICAgICAgICAgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcbi8vXHJcbi8vICAgICAgICAgaWYgKGN1cnJlbnRMZWZ0IDwgMCkge1xyXG4vLyAgICAgICAgICAgICBzY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIjBcIn0pXHJcbi8vICAgICAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICAgICAgc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCItNDAwcHhcIn0pXHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfSk7XHJcbi8vIH0pO1xyXG5cclxuXHJcblxyXG4vL2Nzcmborr7nva5cclxuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcclxuICAgIHZhciBjb29raWVWYWx1ZSA9IG51bGw7XHJcbiAgICBpZiAoZG9jdW1lbnQuY29va2llICYmIGRvY3VtZW50LmNvb2tpZSAhPT0gJycpIHtcclxuICAgICAgICB2YXIgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgY29va2llID0galF1ZXJ5LnRyaW0oY29va2llc1tpXSk7XHJcbiAgICAgICAgICAgIC8vIERvZXMgdGhpcyBjb29raWUgc3RyaW5nIGJlZ2luIHdpdGggdGhlIG5hbWUgd2Ugd2FudD9cclxuICAgICAgICAgICAgaWYgKGNvb2tpZS5zdWJzdHJpbmcoMCwgbmFtZS5sZW5ndGggKyAxKSA9PT0gKG5hbWUgKyAnPScpKSB7XHJcbiAgICAgICAgICAgICAgICBjb29raWVWYWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKG5hbWUubGVuZ3RoICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29va2llVmFsdWU7XHJcbn1cclxuXHJcbnZhciBteWFqYXggPSB7XHJcbiAgICAnZ2V0JzogZnVuY3Rpb24gKGFyZ3MpIHtcclxuICAgICAgICBhcmdzWydtZXRob2QnXSA9ICdnZXQnO1xyXG4gICAgICAgIHRoaXMuYWpheChhcmdzKTtcclxuICAgIH0sXHJcbiAgICAncG9zdCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgYXJnc1snbWV0aG9kJ10gPSAncG9zdCc7XHJcbiAgICAgICAgdGhpcy5fYWpheFNldHVwKCk7XHJcbiAgICAgICAgdGhpcy5hamF4KGFyZ3MpO1xyXG4gICAgfSxcclxuICAgICdhamF4JzogZnVuY3Rpb24gKGFyZ3MpIHtcclxuICAgICAgICAkLmFqYXgoYXJncyk7XHJcbiAgICB9LFxyXG4gICAgJ19hamF4U2V0dXAnOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJC5hamF4U2V0dXAoe1xyXG4gICAgICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHIsIHNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIS9eKEdFVHxIRUFEfE9QVElPTlN8VFJBQ0UpJC8udGVzdChzZXR0aW5ncy50eXBlKSAmJiAhdGhpcy5jcm9zc0RvbWFpbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1DU1JGVG9rZW5cIiwgZ2V0Q29va2llKCdjc3JmdG9rZW4nKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufTtcclxuXHJcbi8vIENvbnN0cnVjdGlvbiBmdW5jdGlvbi5cclxuZnVuY3Rpb24gQXV0aCgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyID0gJChcIi5tYXNrLXdyYXBwZXJcIik7XHJcbiAgICBzZWxmLnNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhID0gJChcIi5zbXMtY2FwdGNoYS1idG5cIik7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICBzZWxmLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbnVwRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuSW1nQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgLy8gU2hvdyBzaW5naW4vc2lnbnVwIHdpbmRvdy5cclxuICAgIHNlbGYubWFza1dyYXBwZXIuc2hvdygpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuaGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgLy8gSGlkZSBzaWduaW4vc2lnbnVwIHdpbmRvdy5cclxuICAgIHNlbGYubWFza1dyYXBwZXIuaGlkZSgpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2hvd0hpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5CdG4gPSAkKFwiLnNpZ25pbi1idG5cIik7XHJcbiAgICB2YXIgc2lnbnVwQnRuID0gJChcIi5zaWdudXAtYnRuXCIpO1xyXG4gICAgdmFyIGNsb3NlQnRuID0gJChcIi5jbG9zZS1idG5cIik7XHJcblxyXG4gICAgLy8gQ2xpY2sgc2lnbmluIGJ1dHRvbiB0byBvcGVuIHNpZ25pbiB3aW5kb3cuXHJcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6IDB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENsaWNrIHNpZ251cCBidXR0b24gdG8gb3BlbiBzaWdudXAgd2luZG93LlxyXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiAtNDAwfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDbGljayBjbG9zZSBidXR0b24gdG8gY2xvc2Ugc2lnbmluL3NpZ251cCB3aW5kb3cuXHJcbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8gU2lnbmluL3NpZ251cCB3aW5kb3cgc3dpdGNoLlxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHN3aXRjaGVyID0gJChcIi5zd2l0Y2hcIik7XHJcblxyXG4gICAgc3dpdGNoZXIuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoXCJsZWZ0XCIpO1xyXG4gICAgICAgIC8vIFwibGVmdDogMTBweFwiIC0+IFwiMTBcIi5cclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuXHJcbiAgICAgICAgaWYgKGN1cnJlbnRMZWZ0IDwgMCkge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiMFwifSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbmluRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbmluR3JvdXAgPSAkKFwiLnNpZ25pbi1ncm91cFwiKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHZhciBwYXNzd29yZElucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkJ11cIik7XHJcbiAgICB2YXIgcmVtZW1iZXJJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdyZW1lbWJlciddXCIpO1xyXG5cclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWduaW5Hcm91cC5maW5kKFwiLnN1Ym1pdC1idG5cIik7XHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkID0gcGFzc3dvcmRJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXI/MTowLFxyXG4gICAgICAgICAgICAgICAgJ2NzcmZtaWRkbGV3YXJldG9rZW4nOiAkKCcjY3NyZl90b2tlbicpLnZhbCgpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNpZ251cEdyb3VwID0gJChcIi5zaWdudXAtZ3JvdXBcIik7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbnVwR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQySW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XHJcbiAgICAgICAgdmFyIHNtc0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nQ2FwdGNoYSA9IGltZ0NhcHRjaGFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQxID0gcGFzc3dvcmQxSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMiA9IHBhc3N3b3JkMklucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBzbXNDYXB0Y2hhID0gc21zQ2FwdGNoYUlucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICBcInVybFwiOiBcIi9hY2NvdW50L3JlZ2lzdGVyL1wiLFxyXG4gICAgICAgICAgICBcImRhdGFcIjoge1xyXG4gICAgICAgICAgICAgICAgXCJ0ZWxlcGhvbmVcIjogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgXCJ1c2VybmFtZVwiOiB1c2VybmFtZSxcclxuICAgICAgICAgICAgICAgIFwiaW1nX2NhcHRjaGFcIjogaW1nQ2FwdGNoYSxcclxuICAgICAgICAgICAgICAgIFwicGFzc3dvcmQxXCI6IHBhc3N3b3JkMSxcclxuICAgICAgICAgICAgICAgIFwicGFzc3dvcmQyXCI6IHBhc3N3b3JkMixcclxuICAgICAgICAgICAgICAgIFwic21zX2NhcHRjaGFcIjogc21zQ2FwdGNoYVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcInN1Y2Nlc3NcIjogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwiZmFpbFwiOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihcIlNlcnZlciBpbnRlcm5hbCBlcnJvci5cIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1nQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGltZ0NhcHRjaGEgPSAkKCcuaW1nLWNhcHRjaGEnKTtcclxuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGltZ0NhcHRjaGEuYXR0cihcInNyY1wiLCBcIi9hY2NvdW50L2ltZ19jYXB0Y2hhL1wiK1wiP3JhbmRvbT1cIitNYXRoLnJhbmRvbSgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2Vzcygn55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5YqfJyk7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7ICAgIC8vIOWwhuWPkemAgemqjOivgeeggeaMiemSruWPmOaIkOeBsOiJslxyXG4gICAgdmFyIGNvdW50ID0gMzA7ICAgICAvLyA2MOenkuWAkuiuoeaXtlxyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLnVuYmluZCgnY2xpY2snKTsgICAgIC8vIOWPlua2iOaMiemSrueCueWHu1xyXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KGNvdW50ICsgXCJzXCIpOyAgICAgLy8g5pi+56S65YCS6K6h5pe2XHJcbiAgICAgICAgY291bnQtLTsgICAgLy8g5YCS6K6h5pe26Ieq5YePMVxyXG4gICAgICAgIGlmIChjb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpOyAgIC8v5YCS6K6h5pe2NjDnp5Lnu5PmnZ/vvIzlgZzmraLlgJLorqHml7ZcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpOyAgICAgLy8g5bCG5Y+R6YCB5oyJ6ZKu5Y+Y5Zue5q2j5bi45pi+56S6XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KCflj5HpgIHpqozor4HnoIEnKTsgICAvLyDmjInpkq7mloflrZflj5jlm57mraPluLjmmL7npLpcclxuICAgICAgICAgICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTsgICAvLyDph43mlrDmiafooYzlh73mlbBcclxuICAgICAgICB9XHJcbiAgICB9LCAxMDAwKTsgICAvLyDlgJLorqHml7bpl7TpmpQxMDAw5q+r56eSXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gJChcIi5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICBzbXNDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgaWYgKCF0ZWxlcGhvbmUpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygnUGxlYXNlIHR5cGUgYSB0ZWxlcGhvbmUgbnVtYmVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvc21zX2NhcHRjaGEvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJyA6IHRlbGVwaG9uZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc1N1Y2Nlc3NFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBhdXRoID0gbmV3IEF1dGgoKTtcclxuICAgYXV0aC5ydW4oKTtcclxufSk7XHJcblxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZnJvbnRCYXNlID0gbmV3IEZyb250QmFzZSgpO1xyXG4gICAgZnJvbnRCYXNlLnJ1bigpO1xyXG59KTtcclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgaWYgKHRlbXBsYXRlKSB7XHJcbiAgICAgICAgdGVtcGxhdGUuZGVmYXVsdHMuaW1wb3J0cy50aW1lU2luY2UgPSBmdW5jdGlvbiAoZGF0ZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpOyAgICAvLyBUaW1lIGluIG1pbGxpc2Vjb25kLlxyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICB2YXIgdGltZVN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKSAvIDEwMDA7IC8vIEluIHNlY29uZC5cclxuXHJcbiAgICAgICAgICAgIGlmICh0aW1lU3RhbXAgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICfliJrliJonO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVTdGFtcCA+PSA2MCAmJiB0aW1lU3RhbXAgPCA2MCo2MCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lU3RhbXAvNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICBtaW51dGVzICsgJ+WIhumSn+WJjSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZVN0YW1wID49IDYwKjYwICYmIHRpbWVTdGFtcCA8IDYwKjYwKjI0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91cnMgPSBwYXJzZUludCh0aW1lU3RhbXAvNjAvNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXJzICsgJ+Wwj+aXtuWJjSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRpbWVTdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lU3RhbXAgPCA2MCo2MCoyNCozMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheXMgPSBwYXJzZUludCh0aW1lU3RhbXAvNjAvNjAvMjQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheXMgKyAn5aSp5YmNJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyICsgXCIvXCIgKyBtb250aCArIFwiL1wiICsgZGF5ICsgXCIgXCIgKyBob3VyICsgXCI6IFwiICsgbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICB9XHJcbn0pO1xyXG5cclxuLy8gdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuLy8gc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4vLyAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuLy8gICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbi8vICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG4vL1xyXG4vLyAgICAgbXlhamF4LnBvc3Qoe1xyXG4vLyAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcclxuLy8gICAgICAgICAnZGF0YSc6IHtcclxuLy8gICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuLy8gICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXHJcbi8vICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PScpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnPT09PT09PT09PT09PT0nKTtcclxuLy8gICAgICAgICB9LFxyXG4vLyAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuIl19
