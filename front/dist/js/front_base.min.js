function FrontBase(){}function getCookie(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var i=jQuery.trim(n[o]);if(i.substring(0,t.length+1)===t+"="){e=decodeURIComponent(i.substring(t.length+1));break}}return e}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})};var myajax={get:function(t){t.method="get",this.ajax(t)},post:function(t){t.method="post",this._ajaxSetup(),this.ajax(t)},ajax:function(t){$.ajax(t)},_ajaxSetup:function(){$.ajaxSetup({beforeSend:function(t,e){/^(GET|HEAD|OPTIONS|TRACE)$/.test(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",getCookie("csrftoken"))}})}};function Auth(){this.maskWrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper")}Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),o=$(".close-btn");e.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),o.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:"0"}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var i=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),a=t.find("input[name='password']"),r=t.find("input[name='remember']");t.find(".submit-btn").click(function(t){t.preventDefault();var e=s.val(),n=a.val(),o=r.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:e,password:n,remember:o?1:0,csrfmiddlewaretoken:$("#csrf_token").val()},success:function(t){if(console.log(t),200===t.code)i.hideEvent(),window.location.reload();else{console.log("Login failed.");var e=t.message;if("string"==typeof e||e.constructor==String)console.log(e),window.messageBox.show(e);else for(var n in e){var o=e[n][0];console.log(o),window.messageBox.show(o)}}},fail:function(t){console.log(t)}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSmsCaptchaEvent=function(){var o=$(".sms-captcha-btn"),e=$(".signup-group input[name='telephone']");o.click(function(){var t=e.val();t||messageBox.showInfo("Please type a telephone number."),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){if(200==t.code){messageBox.showSuccess("短信验证码发送成功"),o.addClass("disabled");var e=60,n=setInterval(function(){o.text(e+"s"),--e<=0&&(clearInterval(n),o.removeClass("disabled"),o.text("发送验证码"))},1e3)}},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiZ2V0Q29va2llIiwibmFtZSIsImNvb2tpZVZhbHVlIiwiZG9jdW1lbnQiLCJjb29raWUiLCJjb29raWVzIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwialF1ZXJ5IiwidHJpbSIsInN1YnN0cmluZyIsImRlY29kZVVSSUNvbXBvbmVudCIsInByb3RvdHlwZSIsInJ1biIsInRoaXMiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwiJCIsInVzZXJNb3JlQm94IiwiaG92ZXIiLCJzaG93IiwiaGlkZSIsIm15YWpheCIsImdldCIsImFyZ3MiLCJhamF4IiwicG9zdCIsIl9hamF4U2V0dXAiLCJhamF4U2V0dXAiLCJiZWZvcmVTZW5kIiwieGhyIiwic2V0dGluZ3MiLCJ0ZXN0IiwidHlwZSIsImNyb3NzRG9tYWluIiwic2V0UmVxdWVzdEhlYWRlciIsIkF1dGgiLCJtYXNrV3JhcHBlciIsInNjcm9sbFdyYXBwZXIiLCJzZWxmIiwibGlzdGVuU2hvd0hpZGVFdmVudCIsImxpc3RlblN3aXRjaEV2ZW50IiwibGlzdGVuU2lnbmluRXZlbnQiLCJsaXN0ZW5JbWdDYXB0Y2hhRXZlbnQiLCJsaXN0ZW5TbXNDYXB0Y2hhRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsImN1cnJlbnRMZWZ0IiwicGFyc2VJbnQiLCJhbmltYXRlIiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsInhmemFqYXgiLCJ1cmwiLCJkYXRhIiwiY3NyZm1pZGRsZXdhcmV0b2tlbiIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJjb25zb2xlIiwibG9nIiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJtZXNzYWdlT2JqZWN0IiwiY29uc3RydWN0b3IiLCJTdHJpbmciLCJtZXNzYWdlQm94Iiwia2V5IiwibWVzc2FnZSIsImZhaWwiLCJlcnJvciIsImltZ0NhcHRjaGEiLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsInNtc0NhcHRjaGEiLCJzaG93SW5mbyIsInNob3dTdWNjZXNzIiwiYWRkQ2xhc3MiLCJjb3VudCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIl0sIm1hcHBpbmdzIjoiQUFDQSxTQUFTQSxhQTBEVCxTQUFTQyxVQUFVQyxHQUNmLElBQUlDLEVBQWMsS0FDbEIsR0FBSUMsU0FBU0MsUUFBOEIsS0FBcEJELFNBQVNDLE9BRTVCLElBREEsSUFBSUMsRUFBVUYsU0FBU0MsT0FBT0UsTUFBTSxLQUMzQkMsRUFBSSxFQUFHQSxFQUFJRixFQUFRRyxPQUFRRCxJQUFLLENBQ3JDLElBQUlILEVBQVNLLE9BQU9DLEtBQUtMLEVBQVFFLElBRWpDLEdBQUlILEVBQU9PLFVBQVUsRUFBR1YsRUFBS08sT0FBUyxLQUFRUCxFQUFPLElBQU0sQ0FDdkRDLEVBQWNVLG1CQUFtQlIsRUFBT08sVUFBVVYsRUFBS08sT0FBUyxJQUNoRSxPQUlaLE9BQU9OLEVBbkVYSCxVQUFVYyxVQUFVQyxJQUFNLFdBQ1hDLEtBRU5DLHNCQUdUakIsVUFBVWMsVUFBVUcsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVDLEVBQUUsYUFDWkMsRUFBY0QsRUFBRSxrQkFFcEJELEVBQVFHLE1BQU0sV0FDVkQsRUFBWUUsUUFDYixXQUNDRixFQUFZRyxVQXlEcEIsSUFBSUMsT0FBUyxDQUNUQyxJQUFPLFNBQVVDLEdBQ2JBLEVBQWEsT0FBSSxNQUNqQlYsS0FBS1csS0FBS0QsSUFFZEUsS0FBUSxTQUFVRixHQUNkQSxFQUFhLE9BQUksT0FDakJWLEtBQUthLGFBQ0xiLEtBQUtXLEtBQUtELElB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QUNmd0MsRUFBaUJ4QyxFQUFFLHlDQUN2QjBFLEVBQVd6QyxNQUFNLFdBQ2IsSUFBSWEsRUFBWU4sRUFBZU8sTUFDMUJELEdBQ0RtQixXQUFXVSxTQUFTLG1DQUV4QnhCLFFBQVE3QyxJQUFJLENBQ1I4QyxJQUFPLHdCQUNQQyxLQUFRLENBQ0pQLFVBQWNBLEdBRWxCUyxRQUFXLFNBQVVDLEdBQ2pCLEdBQXNCLEtBQWxCQSxFQUFhLEtBQVUsQ0FDdkJTLFdBQVdXLFlBQVksYUFDdkJGLEVBQVdHLFNBQVMsWUFDcEIsSUFBSUMsRUFBUSxHQUNSQyxFQUFRQyxZQUFZLFdBQ3BCTixFQUFXTyxLQUFLSCxFQUFNLE9BQ3RCQSxHQUNXLElBQ1BJLGNBQWNILEdBQ2RMLEVBQVdTLFlBQVksWUFDdkJULEVBQVdPLEtBQUssV0FFckIsT0FHWGIsS0FBUSxTQUFVQyxHQUNkWixRQUFRQyxJQUFJVyxTQU01QnJFLEVBQUUsWUFDWSxJQUFJbUIsTUFDVnZCLFFBSVJJLEVBQUUsWUFDa0IsSUFBSW5CLFdBQ1ZlIiwiZmlsZSI6ImZyb250X2Jhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmZ1bmN0aW9uIEZyb250QmFzZSgpIHtcclxuICAgIFxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICBzZWxmLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG59O1xyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIik7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIik7XHJcblxyXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpO1xyXG4gICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vIE9wZW4gLyBjbG9zZSBsb2dpbiBwYWdlLlxyXG4vLyAkKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgIC8vIENsaWNrIG9uIGxvZ2luIGJ1dHRvbi5cclxuLy8gICAgICQoXCIjYnRuXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5zaG93KCk7XHJcbi8vICAgICB9KTtcclxuLy9cclxuLy8gICAgIC8vIENsaWNrIG9uIGNsb3NlIGJ1dHRvbi5cclxuLy8gICAgICQoXCIuY2xvc2UtYnRuXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5oaWRlKCk7XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuLy8gTG9naW4gLyByZWdpc3RlciBzd2l0Y2guXHJcbi8vICQoZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgJChcIi5zd2l0Y2hcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgIHZhciBzY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuLy8gICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbi8vICAgICAgICAgLy8gXCJsZWZ0OiAxMHB4XCIgLT4gXCIxMFwiLlxyXG4vLyAgICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4vL1xyXG4vLyAgICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuLy8gICAgICAgICAgICAgc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCIwXCJ9KVxyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KVxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0pO1xyXG4vLyB9KTtcclxuXHJcblxyXG5cclxuLy9jc3Jm6K6+572uXHJcbmZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XHJcbiAgICB2YXIgY29va2llVmFsdWUgPSBudWxsO1xyXG4gICAgaWYgKGRvY3VtZW50LmNvb2tpZSAmJiBkb2N1bWVudC5jb29raWUgIT09ICcnKSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGpRdWVyeS50cmltKGNvb2tpZXNbaV0pO1xyXG4gICAgICAgICAgICAvLyBEb2VzIHRoaXMgY29va2llIHN0cmluZyBiZWdpbiB3aXRoIHRoZSBuYW1lIHdlIHdhbnQ/XHJcbiAgICAgICAgICAgIGlmIChjb29raWUuc3Vic3RyaW5nKDAsIG5hbWUubGVuZ3RoICsgMSkgPT09IChuYW1lICsgJz0nKSkge1xyXG4gICAgICAgICAgICAgICAgY29va2llVmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoY29va2llLnN1YnN0cmluZyhuYW1lLmxlbmd0aCArIDEpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNvb2tpZVZhbHVlO1xyXG59XHJcblxyXG52YXIgbXlhamF4ID0ge1xyXG4gICAgJ2dldCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgYXJnc1snbWV0aG9kJ10gPSAnZ2V0JztcclxuICAgICAgICB0aGlzLmFqYXgoYXJncyk7XHJcbiAgICB9LFxyXG4gICAgJ3Bvc3QnOiBmdW5jdGlvbiAoYXJncykge1xyXG4gICAgICAgIGFyZ3NbJ21ldGhvZCddID0gJ3Bvc3QnO1xyXG4gICAgICAgIHRoaXMuX2FqYXhTZXR1cCgpO1xyXG4gICAgICAgIHRoaXMuYWpheChhcmdzKTtcclxuICAgIH0sXHJcbiAgICAnYWpheCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgJC5hamF4KGFyZ3MpO1xyXG4gICAgfSxcclxuICAgICdfYWpheFNldHVwJzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQuYWpheFNldHVwKHtcclxuICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyLCBzZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEvXihHRVR8SEVBRHxPUFRJT05TfFRSQUNFKSQvLnRlc3Qoc2V0dGluZ3MudHlwZSkgJiYgIXRoaXMuY3Jvc3NEb21haW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtQ1NSRlRva2VuXCIsIGdldENvb2tpZSgnY3NyZnRva2VuJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBDb25zdHJ1Y3Rpb24gZnVuY3Rpb24uXHJcbmZ1bmN0aW9uIEF1dGgoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoXCIubWFzay13cmFwcGVyXCIpO1xyXG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHNlbGYubGlzdGVuU2hvd0hpZGVFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5Td2l0Y2hFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TaWduaW5FdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zaG93RXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyBTaG93IHNpbmdpbi9zaWdudXAgd2luZG93LlxyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5zaG93KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyBIaWRlIHNpZ25pbi9zaWdudXAgd2luZG93LlxyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5oaWRlKCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93SGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkJ0biA9ICQoXCIuc2lnbmluLWJ0blwiKTtcclxuICAgIHZhciBzaWdudXBCdG4gPSAkKFwiLnNpZ251cC1idG5cIik7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSAkKFwiLmNsb3NlLWJ0blwiKTtcclxuXHJcbiAgICAvLyBDbGljayBzaWduaW4gYnV0dG9uIHRvIG9wZW4gc2lnbmluIHdpbmRvdy5cclxuICAgIHNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogMH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2xpY2sgc2lnbnVwIGJ1dHRvbiB0byBvcGVuIHNpZ251cCB3aW5kb3cuXHJcbiAgICBzaWdudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6IC00MDB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENsaWNrIGNsb3NlIGJ1dHRvbiB0byBjbG9zZSBzaWduaW4vc2lnbnVwIHdpbmRvdy5cclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vLyBTaWduaW4vc2lnbnVwIHdpbmRvdyBzd2l0Y2guXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblN3aXRjaEV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc3dpdGNoZXIgPSAkKFwiLnN3aXRjaFwiKTtcclxuXHJcbiAgICBzd2l0Y2hlci5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbiAgICAgICAgLy8gXCJsZWZ0OiAxMHB4XCIgLT4gXCIxMFwiLlxyXG4gICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG5cclxuICAgICAgICBpZiAoY3VycmVudExlZnQgPCAwKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCIwXCJ9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCItNDAwcHhcIn0pXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWduaW5FdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoXCIuc2lnbmluLWdyb3VwXCIpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcblxyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQgPSBwYXNzd29yZElucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciByZW1lbWJlciA9IHJlbWVtYmVySW5wdXQucHJvcChcImNoZWNrZWRcIik7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICAncmVtZW1iZXInOiByZW1lbWJlcj8xOjAsXHJcbiAgICAgICAgICAgICAgICAnY3NyZm1pZGRsZXdhcmV0b2tlbic6ICQoJyNjc3JmX3Rva2VuJykudmFsKClcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvZ2luIGZhaWxlZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IHJlc3VsdFsnbWVzc2FnZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZU9iamVjdCA9PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09IFN0cmluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlT2JqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbWVzc2FnZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gbWVzc2FnZU9iamVjdFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBtZXNzYWdlc1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIG15YWpheC5wb3N0KHtcclxuICAgICAgICAvLyAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgIC8vICAgICAnZGF0YSc6IHtcclxuICAgICAgICAvLyAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgLy8gICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAvLyAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MCxcclxuICAgICAgICAvLyAgICAgICAgICdjc3JmbWlkZGxld2FyZXRva2VuJzogJCgnI2NzcmZfdG9rZW4nKS52YWwoKVxyXG4gICAgICAgIC8vICAgICB9LFxyXG4gICAgICAgIC8vICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PScpO1xyXG4gICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PScpO1xyXG4gICAgICAgIC8vICAgICB9LFxyXG4gICAgICAgIC8vICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkltZ0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBpbWdDYXB0Y2hhID0gJCgnLmltZy1jYXB0Y2hhJyk7XHJcbiAgICBpbWdDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbWdDYXB0Y2hhLmF0dHIoXCJzcmNcIiwgXCIvYWNjb3VudC9pbWdfY2FwdGNoYS9cIitcIj9yYW5kb209XCIrTWF0aC5yYW5kb20oKSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzbXNDYXB0Y2hhID0gJChcIi5zbXMtY2FwdGNoYS1idG5cIik7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICBpZiAoIXRlbGVwaG9uZSkge1xyXG4gICAgICAgICAgICBtZXNzYWdlQm94LnNob3dJbmZvKCdQbGVhc2UgdHlwZSBhIHRlbGVwaG9uZSBudW1iZXIuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHhmemFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnIDogdGVsZXBob25lXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oemqjOivgeeggeWPkemAgeaIkOWKnycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7ICAgIC8vIOWwhuWPkemAgemqjOivgeeggeaMiemSruWPmOaIkOeBsOiJslxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IDYwOyAgICAgLy8gNjDnp5LlgJLorqHml7ZcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNtc0NhcHRjaGEudGV4dChjb3VudCtcInNcIik7ICAgICAvLyDmmL7npLrlgJLorqHml7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQtLTsgICAgLy8g5YCS6K6h5pe26Ieq5YePMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQ8PTApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpOyAgIC8v5YCS6K6h5pe2NjDnp5Lnu5PmnZ/vvIzlgZzmraLlgJLorqHml7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc0NhcHRjaGEucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7ICAgICAvLyDlsIblj5HpgIHmjInpkq7lj5jlm57mraPluLjmmL7npLpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc0NhcHRjaGEudGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7ICAgLy8g5oyJ6ZKu5paH5a2X5Y+Y5Zue5q2j5bi45pi+56S6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsgICAvLyDlgJLorqHml7bpl7TpmpQxMDAw5q+r56eSXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICBhdXRoLnJ1bigpO1xyXG59KTtcclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuLy8gdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuLy8gc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4vLyAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuLy8gICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbi8vICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG4vL1xyXG4vLyAgICAgbXlhamF4LnBvc3Qoe1xyXG4vLyAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcclxuLy8gICAgICAgICAnZGF0YSc6IHtcclxuLy8gICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuLy8gICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXHJcbi8vICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PScpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnPT09PT09PT09PT09PT0nKTtcclxuLy8gICAgICAgICB9LFxyXG4vLyAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuIl19
