function FrontBase(){}function getCookie(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var o=jQuery.trim(n[a]);if(o.substring(0,t.length+1)===t+"="){e=decodeURIComponent(o.substring(t.length+1));break}}return e}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})};var myajax={get:function(t){t.method="get",this.ajax(t)},post:function(t){t.method="post",this._ajaxSetup(),this.ajax(t)},ajax:function(t){$.ajax(t)},_ajaxSetup:function(){$.ajaxSetup({beforeSend:function(t,e){/^(GET|HEAD|OPTIONS|TRACE)$/.test(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",getCookie("csrftoken"))}})}};function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenSignupEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),a=$(".close-btn");e.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),a.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:"0"}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var t=$(".signin-group"),o=t.find("input[name='telephone']"),s=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(t){t.preventDefault();var e=o.val(),n=s.val(),a=i.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:e,password:n,remember:a?1:0,csrfmiddlewaretoken:$("#csrf_token").val()},success:function(t){window.location.reload()}})})},Auth.prototype.listenSignupEvent=function(){var f=$(".signup-group");f.find(".submit-btn").click(function(t){t.preventDefault();var e=f.find("input[name='telephone']"),n=f.find("input[name='username']"),a=f.find("input[name='img_captcha']"),o=f.find("input[name='password1']"),s=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),c=e.val(),r=n.val(),p=a.val(),u=o.val(),l=s.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200===t.code&&window.location.reload()},fail:function(t){window.messageBox.showError("Server internal error.")}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功"),t.smsCaptcha.addClass("disabled");var e=30;t.smsCaptcha.unbind("click");var n=setInterval(function(){t.smsCaptcha.text(e+"s"),--e<=0&&(clearInterval(n),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var e=this,t=$(".sms-captcha-btn"),n=$(".signup-group input[name='telephone']");t.click(function(){var t=n.val();t||messageBox.showInfo("Please type a telephone number."),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200===t.code&&e.smsSuccessEvent()},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var e=new Date(t),n=e.getTime(),a=((new Date).getTime()-n)/1e3;return a<60?"刚刚":60<=a&&a<3600?parseInt(a/60)+"分钟前":3600<=a&&a<86400?parseInt(a/60/60)+"小时前":86400<=a&&a<2592e3?parseInt(a/60/60/24)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+": "+e.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiZ2V0Q29va2llIiwibmFtZSIsImNvb2tpZVZhbHVlIiwiZG9jdW1lbnQiLCJjb29raWUiLCJjb29raWVzIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwialF1ZXJ5IiwidHJpbSIsInN1YnN0cmluZyIsImRlY29kZVVSSUNvbXBvbmVudCIsInByb3RvdHlwZSIsInJ1biIsInRoaXMiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwiJCIsInVzZXJNb3JlQm94IiwiaG92ZXIiLCJzaG93IiwiaGlkZSIsIm15YWpheCIsImdldCIsImFyZ3MiLCJhamF4IiwicG9zdCIsIl9hamF4U2V0dXAiLCJhamF4U2V0dXAiLCJiZWZvcmVTZW5kIiwieGhyIiwic2V0dGluZ3MiLCJ0ZXN0IiwidHlwZSIsImNyb3NzRG9tYWluIiwic2V0UmVxdWVzdEhlYWRlciIsIkF1dGgiLCJzZWxmIiwibWFza1dyYXBwZXIiLCJzY3JvbGxXcmFwcGVyIiwic21zQ2FwdGNoYSIsImxpc3RlblNob3dIaWRlRXZlbnQiLCJsaXN0ZW5Td2l0Y2hFdmVudCIsImxpc3RlblNpZ25pbkV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJsaXN0ZW5JbWdDYXB0Y2hhRXZlbnQiLCJsaXN0ZW5TbXNDYXB0Y2hhRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsImN1cnJlbnRMZWZ0IiwicGFyc2VJbnQiLCJhbmltYXRlIiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsInhmemFqYXgiLCJ1cmwiLCJkYXRhIiwiY3NyZm1pZGRsZXdhcmV0b2tlbiIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsInNpZ251cEdyb3VwIiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsImltZ0NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJpbWdfY2FwdGNoYSIsInNtc19jYXB0Y2hhIiwiY29kZSIsImZhaWwiLCJlcnJvciIsIm1lc3NhZ2VCb3giLCJzaG93RXJyb3IiLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsInNtc1N1Y2Nlc3NFdmVudCIsInNob3dTdWNjZXNzIiwiYWRkQ2xhc3MiLCJjb3VudCIsInVuYmluZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwic2hvd0luZm8iLCJjb25zb2xlIiwibG9nIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lU3RhbXAiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF5IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIl0sIm1hcHBpbmdzIjoiQUFDQSxTQUFTQSxhQTBEVCxTQUFTQyxVQUFVQyxHQUNmLElBQUlDLEVBQWMsS0FDbEIsR0FBSUMsU0FBU0MsUUFBOEIsS0FBcEJELFNBQVNDLE9BRTVCLElBREEsSUFBSUMsRUFBVUYsU0FBU0MsT0FBT0UsTUFBTSxLQUMzQkMsRUFBSSxFQUFHQSxFQUFJRixFQUFRRyxPQUFRRCxJQUFLLENBQ3JDLElBQUlILEVBQVNLLE9BQU9DLEtBQUtMLEVBQVFFLElBRWpDLEdBQUlILEVBQU9PLFVBQVUsRUFBR1YsRUFBS08sT0FBUyxLQUFRUCxFQUFPLElBQU0sQ0FDdkRDLEVBQWNVLG1CQUFtQlIsRUFBT08sVUFBVVYsRUFBS08sT0FBUyxJQUNoRSxPQUlaLE9BQU9OLEVBbkVYSCxVQUFVYyxVQUFVQyxJQUFNLFdBQ1hDLEtBRU5DLHNCQUdUakIsVUFBVWMsVUFBVUcsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVDLEVBQUUsYUFDWkMsRUFBY0QsRUFBRSxrQkFFcEJELEVBQVFHLE1BQU0sV0FDVkQsRUFBWUUsUUFDYixXQUNDRixFQUFZRyxVQXlEcEIsSUFBSUMsT0FBUyxDQUNUQyxJQUFPLFNBQVVDLEdBQ2JBLEVBQWEsT0FBSSxNQUNqQlYsS0FBS1csS0FBS0QsSUFFZEUsS0FBUSxTQUFVRixHQUNkQSxFQUFhLE9BQUksT0FDakJWLEtBQUthLGFBQ0xiLEtBQUtXLEtBQUtELElBRWRDLEtBQVEsU0FBVUQsR0FDZFAsRUFBRVEsS0FBS0QsSUFFWEcsV0FBYyxXQUNWVixFQUFFVyxVQUFVLENBQ1JDLFdBQVksU0FBU0MsRUFBS0MsR0FDakIsNkJBQTZCQyxLQUFLRCxFQUFTRSxPQUFVbkIsS0FBS29CLGFBQzNESixFQUFJSyxpQkFBaUIsY0FBZXBDLFVBQVUsbUJBUWxFLFNBQVNxQyxPQUNMLElBQUlDLEVBQU92QixLQUVYdUIsRUFBS0MsWUFBY3JCLEVBQUUsaUJBQ3JCb0IsRUFBS0UsY0FBZ0J0QixFQUFFLG1CQUN2Qm9CLEVBQUtHLFdBQWF2QixFQUFFLG9CQUd4Qm1CLEtBQUt4QixVQUFVQyxJQUFNLFdBQ2pCLElBQUl3QixFQUFPdkIsS0FFWHVCLEVBQUtJLHNCQUNMSixFQUFLSyxvQkFDTEwsRUFBS00sb0JBQ0xOLEVBQUtPLG9CQUNMUCxFQUFLUSx3QkFDTFIsRUFBS1MseUJBR1RWLEtBQUt4QixVQUFVbUMsVUFBWSxXQUNaakMsS0FFTndCLFlBQVlsQixRQUdyQmdCLEtBQUt4QixVQUFVb0MsVUFBWSxXQUNabEMsS0FFTndCLFlBQVlqQixRQUdyQmUsS0FBS3hCLFVBQVU2QixvQkFBc0IsV0FDakMsSUFBSUosRUFBT3ZCLEtBQ1BtQyxFQUFZaEMsRUFBRSxlQUNkaUMsRUFBWWpDLEVBQUUsZUFDZGtDLEVBQVdsQyxFQUFFLGNBR2pCZ0MsRUFBVUcsTUFBTSxXQUNaZixFQUFLVSxZQUNMVixFQUFLRSxjQUFjYyxJQUFJLENBQUNDLEtBQVEsTUFJcENKLEVBQVVFLE1BQU0sV0FDWmYsRUFBS1UsWUFDTFYsRUFBS0UsY0FBY2MsSUFBSSxDQUFDQyxNQUFTLFFBSXJDSCxFQUFTQyxNQUFNLFdBQ1hmLEVBQUtXLGVBS2JaLEtBQUt4QixVQUFVOEIsa0JBQW9CLFdBQy9CLElBQUlMLEVBQU92QixLQUNJRyxFQUFFLFdBRVJtQyxNQUFNLFdBQ1gsSUFBSUcsRUFBY2xCLEVBQUtFLGNBQWNjLElBQUksU0FFekNFLEVBQWNDLFNBQVNELElBRUwsRUFDZGxCLEVBQUtFLGNBQWNrQixRQUFRLENBQUNILEtBQVEsTUFFcENqQixFQUFLRSxjQUFja0IsUUFBUSxDQUFDSCxLQUFRLGNBS2hEbEIsS0FBS3hCLFVBQVUrQixrQkFBb0IsV0FDL0IsSUFDSWUsRUFBY3pDLEVBQUUsaUJBQ2hCMEMsRUFBaUJELEVBQVlFLEtBQUssMkJBQ2xDQyxFQUFnQkgsRUFBWUUsS0FBSywwQkFDakNFLEVBQWdCSixFQUFZRSxLQUFLLDBCQUVyQkYsRUFBWUUsS0FBSyxlQUN2QlIsTUFBTSxTQUFVVyxHQUN0QkEsRUFBTUMsaUJBQ04sSUFBSUMsRUFBWU4sRUFBZU8sTUFDM0JDLEVBQVdOLEVBQWNLLE1BQ3pCRSxFQUFXTixFQUFjTyxLQUFLLFdBRWxDQyxRQUFRNUMsS0FBSyxDQUNUNkMsSUFBTyxrQkFDUEMsS0FBUSxDQUNKUCxVQUFhQSxFQUNiRSxTQUFZQSxFQUNaQyxTQUFZQSxFQUFTLEVBQUUsRUFDdkJLLG9CQUF1QnhELEVBQUUsZUFBZWlELE9BRTVDUSxRQUFXLFNBQVVDLEdBQ2pCQyxPQUFPQyxTQUFTQyxlQU1oQzFDLEtBQUt4QixVQUFVZ0Msa0JBQW9CLFdBQy9CLElBQUltQyxFQUFjOUQsRUFBRSxpQkFDSjhELEVBQVluQixLQUFLLGVBQ3ZCUixNQUFNLFNBQVVXLEdBQ3RCQSxFQUFNQyxpQkFDTixJQUFJTCxFQUFpQm9CLEVBQVluQixLQUFLLDJCQUNsQ29CLEVBQWdCRCxFQUFZbkIsS0FBSywwQkFDakNxQixFQUFrQkYsRUFBWW5CLEtBQUssNkJBQ25Dc0IsRUFBaUJILEVBQVluQixLQUFLLDJCQUNsQ3VCLEVBQWlCSixFQUFZbkIsS0FBSywyQkFDbEN3QixFQUFrQkwsRUFBWW5CLEtBQUssNkJBRW5DSyxFQUFZTixFQUFlTyxNQUMzQm1CLEVBQVdMLEVBQWNkLE1BQ3pCb0IsRUFBYUwsRUFBZ0JmLE1BQzdCcUIsRUFBWUwsRUFBZWhCLE1BQzNCc0IsRUFBWUwsRUFBZWpCLE1BQzNCMUIsRUFBYTRDLEVBQWdCbEIsTUFFakNJLFFBQVE1QyxLQUFLLENBQ1Q2QyxJQUFPLHFCQUNQQyxLQUFRLENBQ0pQLFVBQWFBLEVBQ2JvQixTQUFZQSxFQUNaSSxZQUFlSCxFQUNmQyxVQUFhQSxFQUNiQyxVQUFhQSxFQUNiRSxZQUFlbEQsR0FFbkJrQyxRQUFXLFNBQVVDLEdBQ0csTUFBaEJBLEVBQU9nQixNQUNQZixPQUFPQyxTQUFTQyxVQUd4QmMsS0FBUSxTQUFVQyxHQUNkakIsT0FBT2tCLFdBQVdDLFVBQVUsZ0NBTTVDM0QsS0FBS3hCLFVBQVVpQyxzQkFBd0IsV0FDbkMsSUFBSXlDLEVBQWFyRSxFQUFFLGdCQUNuQnFFLEVBQVdsQyxNQUFNLFdBQ2JrQyxFQUFXVSxLQUFLLE1BQU8sZ0NBQW1DQyxLQUFLQyxhQUl2RTlELEtBQUt4QixVQUFVdUYsZ0JBQWtCLFdBQzdCLElBQUk5RCxFQUFPdkIsS0FDWGdGLFdBQVdNLFlBQVksYUFDdkIvRCxFQUFLRyxXQUFXNkQsU0FBUyxZQUN6QixJQUFJQyxFQUFRLEdBQ1pqRSxFQUFLRyxXQUFXK0QsT0FBTyxTQUN2QixJQUFJQyxFQUFRQyxZQUFZLFdBQ3BCcEUsRUFBS0csV0FBV2tFLEtBQUtKLEVBQVEsT0FDN0JBLEdBQ2EsSUFDVEssY0FBY0gsR0FDZG5FLEVBQUtHLFdBQVdvRSxZQUFZLFlBQzVCdkUsRUFBS0csV0FBV2tFLEtBQUssU0FDckJyRSxFQUFLUywwQkFFVixNQUdQVixLQUFLeEIsVUFBVWtDLHNCQUF3QixXQUNuQyxJQUFJVCxFQUFPdkIsS0FDUDBCLEVBQWF2QixFQUFFLG9CQUNmMEMsRUFBaUIxQyxFQUFFLHlDQUN2QnVCLEVBQVdZLE1BQU0sV0FDYixJQUFJYSxFQUFZTixFQUFlTyxNQUMxQkQsR0FDRDZCLFdBQVdlLFNBQVMsbUNBRXhCdkMsUUFBUS9DLElBQUksQ0FDUmdELElBQU8sd0JBQ1BDLEtBQVEsQ0FDSlAsVUFBY0EsR0FFbEJTLFFBQVcsU0FBVUMsR0FDTSxNQUFuQkEsRUFBYSxNQUNidEMsRUFBSzhELG1CQUdiUCxLQUFRLFNBQVVDLEdBQ2RpQixRQUFRQyxJQUFJbEIsU0FNNUI1RSxFQUFFLFlBQ1ksSUFBSW1CLE1BQ1Z2QixRQUlSSSxFQUFFLFlBQ2tCLElBQUluQixXQUNWZSxRQUlkSSxFQUFFLFdBQ0syRCxPQUFPb0MsV0FDTkEsU0FBU0MsU0FBU0MsUUFBUUMsVUFBWSxTQUFVQyxHQUM1QyxJQUFJQyxFQUFPLElBQUlDLEtBQUtGLEdBQ2hCRyxFQUFTRixFQUFLRyxVQUVkQyxJQURRLElBQUtILE1BQVFFLFVBQ0FELEdBQVUsSUFFbkMsT0FBSUUsRUFBWSxHQUNMLEtBQ2EsSUFBYkEsR0FBbUJBLEVBQVksS0FDeEJqRSxTQUFTaUUsRUFBVSxJQUNmLE1BQ0UsTUFBYkEsR0FBc0JBLEVBQVksTUFDN0JqRSxTQUFTaUUsRUFBVSxHQUFHLElBQ25CLE1BQ00sT0FBYkEsR0FBeUJBLEVBQVksT0FDbENqRSxTQUFTaUUsRUFBVSxHQUFHLEdBQUcsSUFDdEIsS0FFSEosRUFBS0ssY0FLRixJQUpGTCxFQUFLTSxXQUlXLElBSGxCTixFQUFLTyxTQUd5QixJQUY3QlAsRUFBS1EsV0FFcUMsS0FEeENSLEVBQUtTIiwiZmlsZSI6ImZyb250X2Jhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmZ1bmN0aW9uIEZyb250QmFzZSgpIHtcclxuICAgIFxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICBzZWxmLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG59O1xyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIik7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIik7XHJcblxyXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpO1xyXG4gICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vIE9wZW4gLyBjbG9zZSBsb2dpbiBwYWdlLlxyXG4vLyAkKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgIC8vIENsaWNrIG9uIGxvZ2luIGJ1dHRvbi5cclxuLy8gICAgICQoXCIjYnRuXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5zaG93KCk7XHJcbi8vICAgICB9KTtcclxuLy9cclxuLy8gICAgIC8vIENsaWNrIG9uIGNsb3NlIGJ1dHRvbi5cclxuLy8gICAgICQoXCIuY2xvc2UtYnRuXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5oaWRlKCk7XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuLy8gTG9naW4gLyByZWdpc3RlciBzd2l0Y2guXHJcbi8vICQoZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgJChcIi5zd2l0Y2hcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgIHZhciBzY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuLy8gICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbi8vICAgICAgICAgLy8gXCJsZWZ0OiAxMHB4XCIgLT4gXCIxMFwiLlxyXG4vLyAgICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4vL1xyXG4vLyAgICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuLy8gICAgICAgICAgICAgc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCIwXCJ9KVxyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KVxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0pO1xyXG4vLyB9KTtcclxuXHJcblxyXG5cclxuLy9jc3Jm6K6+572uXHJcbmZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XHJcbiAgICB2YXIgY29va2llVmFsdWUgPSBudWxsO1xyXG4gICAgaWYgKGRvY3VtZW50LmNvb2tpZSAmJiBkb2N1bWVudC5jb29raWUgIT09ICcnKSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGpRdWVyeS50cmltKGNvb2tpZXNbaV0pO1xyXG4gICAgICAgICAgICAvLyBEb2VzIHRoaXMgY29va2llIHN0cmluZyBiZWdpbiB3aXRoIHRoZSBuYW1lIHdlIHdhbnQ/XHJcbiAgICAgICAgICAgIGlmIChjb29raWUuc3Vic3RyaW5nKDAsIG5hbWUubGVuZ3RoICsgMSkgPT09IChuYW1lICsgJz0nKSkge1xyXG4gICAgICAgICAgICAgICAgY29va2llVmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoY29va2llLnN1YnN0cmluZyhuYW1lLmxlbmd0aCArIDEpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNvb2tpZVZhbHVlO1xyXG59XHJcblxyXG52YXIgbXlhamF4ID0ge1xyXG4gICAgJ2dldCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgYXJnc1snbWV0aG9kJ10gPSAnZ2V0JztcclxuICAgICAgICB0aGlzLmFqYXgoYXJncyk7XHJcbiAgICB9LFxyXG4gICAgJ3Bvc3QnOiBmdW5jdGlvbiAoYXJncykge1xyXG4gICAgICAgIGFyZ3NbJ21ldGhvZCddID0gJ3Bvc3QnO1xyXG4gICAgICAgIHRoaXMuX2FqYXhTZXR1cCgpO1xyXG4gICAgICAgIHRoaXMuYWpheChhcmdzKTtcclxuICAgIH0sXHJcbiAgICAnYWpheCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgJC5hamF4KGFyZ3MpO1xyXG4gICAgfSxcclxuICAgICdfYWpheFNldHVwJzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQuYWpheFNldHVwKHtcclxuICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyLCBzZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEvXihHRVR8SEVBRHxPUFRJT05TfFRSQUNFKSQvLnRlc3Qoc2V0dGluZ3MudHlwZSkgJiYgIXRoaXMuY3Jvc3NEb21haW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtQ1NSRlRva2VuXCIsIGdldENvb2tpZSgnY3NyZnRva2VuJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBDb25zdHJ1Y3Rpb24gZnVuY3Rpb24uXHJcbmZ1bmN0aW9uIEF1dGgoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoXCIubWFzay13cmFwcGVyXCIpO1xyXG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblN3aXRjaEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ251cEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIFNob3cgc2luZ2luL3NpZ251cCB3aW5kb3cuXHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIEhpZGUgc2lnbmluL3NpZ251cCB3aW5kb3cuXHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbmluQnRuID0gJChcIi5zaWduaW4tYnRuXCIpO1xyXG4gICAgdmFyIHNpZ251cEJ0biA9ICQoXCIuc2lnbnVwLWJ0blwiKTtcclxuICAgIHZhciBjbG9zZUJ0biA9ICQoXCIuY2xvc2UtYnRuXCIpO1xyXG5cclxuICAgIC8vIENsaWNrIHNpZ25pbiBidXR0b24gdG8gb3BlbiBzaWduaW4gd2luZG93LlxyXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiAwfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDbGljayBzaWdudXAgYnV0dG9uIHRvIG9wZW4gc2lnbnVwIHdpbmRvdy5cclxuICAgIHNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogLTQwMH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2xpY2sgY2xvc2UgYnV0dG9uIHRvIGNsb3NlIHNpZ25pbi9zaWdudXAgd2luZG93LlxyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIFNpZ25pbi9zaWdudXAgd2luZG93IHN3aXRjaC5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzd2l0Y2hlciA9ICQoXCIuc3dpdGNoXCIpO1xyXG5cclxuICAgIHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICAvLyBcImxlZnQ6IDEwcHhcIiAtPiBcIjEwXCIuXHJcbiAgICAgICAgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcblxyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIjBcIn0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIi00MDBweFwifSlcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJChcIi5zaWduaW4tZ3JvdXBcIik7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICB2YXIgcGFzc3dvcmRJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xyXG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncmVtZW1iZXInXVwiKTtcclxuXHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbmluR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MCxcclxuICAgICAgICAgICAgICAgICdjc3JmbWlkZGxld2FyZXRva2VuJzogJCgnI2NzcmZfdG9rZW4nKS52YWwoKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzaWdudXBHcm91cCA9ICQoXCIuc2lnbnVwLWdyb3VwXCIpO1xyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xyXG4gICAgICAgIHZhciBpbWdDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0naW1nX2NhcHRjaGEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQxSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQxJ11cIik7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMklucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMiddXCIpO1xyXG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0nc21zX2NhcHRjaGEnXVwiKTtcclxuXHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgc21zQ2FwdGNoYSA9IHNtc0NhcHRjaGFJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgXCJ1cmxcIjogXCIvYWNjb3VudC9yZWdpc3Rlci9cIixcclxuICAgICAgICAgICAgXCJkYXRhXCI6IHtcclxuICAgICAgICAgICAgICAgIFwidGVsZXBob25lXCI6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgIFwidXNlcm5hbWVcIjogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBcImltZ19jYXB0Y2hhXCI6IGltZ0NhcHRjaGEsXHJcbiAgICAgICAgICAgICAgICBcInBhc3N3b3JkMVwiOiBwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAgICBcInBhc3N3b3JkMlwiOiBwYXNzd29yZDIsXHJcbiAgICAgICAgICAgICAgICBcInNtc19jYXB0Y2hhXCI6IHNtc0NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJzdWNjZXNzXCI6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcImZhaWxcIjogZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoXCJTZXJ2ZXIgaW50ZXJuYWwgZXJyb3IuXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkltZ0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBpbWdDYXB0Y2hhID0gJCgnLmltZy1jYXB0Y2hhJyk7XHJcbiAgICBpbWdDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbWdDYXB0Y2hhLmF0dHIoXCJzcmNcIiwgXCIvYWNjb3VudC9pbWdfY2FwdGNoYS9cIitcIj9yYW5kb209XCIrTWF0aC5yYW5kb20oKSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnNtc1N1Y2Nlc3NFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIG1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oemqjOivgeeggeWPkemAgeaIkOWKnycpO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLmFkZENsYXNzKCdkaXNhYmxlZCcpOyAgICAvLyDlsIblj5HpgIHpqozor4HnoIHmjInpkq7lj5jmiJDngbDoibJcclxuICAgIHZhciBjb3VudCA9IDMwOyAgICAgLy8gNjDnp5LlgJLorqHml7ZcclxuICAgIHNlbGYuc21zQ2FwdGNoYS51bmJpbmQoJ2NsaWNrJyk7ICAgICAvLyDlj5bmtojmjInpkq7ngrnlh7tcclxuICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dChjb3VudCArIFwic1wiKTsgICAgIC8vIOaYvuekuuWAkuiuoeaXtlxyXG4gICAgICAgIGNvdW50LS07ICAgIC8vIOWAkuiuoeaXtuiHquWHjzFcclxuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTsgICAvL+WAkuiuoeaXtjYw56eS57uT5p2f77yM5YGc5q2i5YCS6K6h5pe2XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTsgICAgIC8vIOWwhuWPkemAgeaMiemSruWPmOWbnuato+W4uOaYvuekulxyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7ICAgLy8g5oyJ6ZKu5paH5a2X5Y+Y5Zue5q2j5bi45pi+56S6XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7ICAgLy8g6YeN5paw5omn6KGM5Ye95pWwXHJcbiAgICAgICAgfVxyXG4gICAgfSwgMTAwMCk7ICAgLy8g5YCS6K6h5pe26Ze06ZqUMTAwMOavq+enklxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNtc0NhcHRjaGEgPSAkKFwiLnNtcy1jYXB0Y2hhLWJ0blwiKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIGlmICghdGVsZXBob25lKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd0luZm8oJ1BsZWFzZSB0eXBlIGEgdGVsZXBob25lIG51bWJlci4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3Ntc19jYXB0Y2hhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZScgOiB0ZWxlcGhvbmVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2Vzc0V2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICBhdXRoLnJ1bigpO1xyXG59KTtcclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICBpZiAod2luZG93LnRlbXBsYXRlKSB7XHJcbiAgICAgICAgdGVtcGxhdGUuZGVmYXVsdHMuaW1wb3J0cy50aW1lU2luY2UgPSBmdW5jdGlvbiAoZGF0ZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpOyAgICAvLyBUaW1lIGluIG1pbGxpc2Vjb25kLlxyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICB2YXIgdGltZVN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKSAvIDEwMDA7IC8vIEluIHNlY29uZC5cclxuXHJcbiAgICAgICAgICAgIGlmICh0aW1lU3RhbXAgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICfliJrliJonO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVTdGFtcCA+PSA2MCAmJiB0aW1lU3RhbXAgPCA2MCo2MCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lU3RhbXAvNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICBtaW51dGVzICsgJ+WIhumSn+WJjSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZVN0YW1wID49IDYwKjYwICYmIHRpbWVTdGFtcCA8IDYwKjYwKjI0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91cnMgPSBwYXJzZUludCh0aW1lU3RhbXAvNjAvNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXJzICsgJ+Wwj+aXtuWJjSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRpbWVTdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lU3RhbXAgPCA2MCo2MCoyNCozMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheXMgPSBwYXJzZUludCh0aW1lU3RhbXAvNjAvNjAvMjQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheXMgKyAn5aSp5YmNJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyICsgXCIvXCIgKyBtb250aCArIFwiL1wiICsgZGF5ICsgXCIgXCIgKyBob3VyICsgXCI6IFwiICsgbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICB9XHJcbn0pO1xyXG5cclxuLy8gdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuLy8gc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4vLyAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuLy8gICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbi8vICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG4vL1xyXG4vLyAgICAgbXlhamF4LnBvc3Qoe1xyXG4vLyAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcclxuLy8gICAgICAgICAnZGF0YSc6IHtcclxuLy8gICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuLy8gICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXHJcbi8vICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PScpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnPT09PT09PT09PT09PT0nKTtcclxuLy8gICAgICAgICB9LFxyXG4vLyAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuIl19
