function Banner(){this.index=1,this.bannerWidth=798,this.bannerGroup=$("#banner-group"),this.leftArrow=$(".left-arrow"),this.rightArrow=$(".right-arrow"),this.bannerUl=$(".banner-ul"),this.pageControl=$(".page-control"),this.liList=this.bannerUl.children("li"),this.bannerCount=this.liList.length}function Index(){var n=this;n.page=2,n.category_id=0,n.loadMoreBtn=$("#load-more-btn")}Banner.prototype.initBanner=function(){var n=this,t=n.liList.eq(0).clone(),e=n.liList.eq(n.bannerCount-1).clone();n.bannerUl.append(t),n.bannerUl.prepend(e),n.bannerUl.css({width:n.bannerWidth*(n.bannerCount+2),left:-n.bannerWidth})},Banner.prototype.initPageControl=function(){for(var n=this,t=0;t<n.bannerCount;t++){var e=$("<li></li>");n.pageControl.append(e),0===t&&e.addClass("active"),n.pageControl.css({width:28*n.bannerCount})}},Banner.prototype.toggleArrow=function(n){var t=this;n?(t.leftArrow.show(),t.rightArrow.show()):(t.leftArrow.hide(),t.rightArrow.hide())},Banner.prototype.animate=function(){var n=this;n.bannerUl.stop().animate({left:-798*n.index},1e3);var t=n.index;0===t?t=n.bannerCount-1:t===n.bannerCount+1?t=0:t-=1,n.pageControl.children("li").eq(t).addClass("active").siblings().removeClass("active")},Banner.prototype.loop=function(){var n=this;this.timer=setInterval(function(){n.index>=n.bannerCount+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=2):n.index++,n.animate()},5e3)},Banner.prototype.listenArrowClick=function(){var n=this;n.leftArrow.click(function(){0===n.index?(n.bannerUl.css({left:-n.bannerCount*n.bannerWidth}),n.index=n.bannerCount-1):n.index--,n.animate()}),n.rightArrow.click(function(){n.index===n.bannerCount+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=2):n.index++,n.animate()})},Banner.prototype.listenBannerHover=function(){var n=this;this.bannerGroup.hover(function(){clearInterval(n.timer),n.toggleArrow(!0)},function(){n.loop(),n.toggleArrow(!1)})},Banner.prototype.listenPageControl=function(){var e=this;e.pageControl.children("li").each(function(n,t){$(t).click(function(){e.index=n+1,e.animate()})})},Banner.prototype.run=function(){this.initBanner(),this.initPageControl(),this.loop(),this.listenBannerHover(),this.listenArrowClick(),this.listenPageControl()},Index.prototype.listenLoadMoreEvent=function(){var i=this;i.loadMoreBtn.click(function(){xfzajax.get({url:"/news/list/",data:{p:i.page,category_id:i.category_id},success:function(n){if(200===n.code){var t=n.data;if(0<t.length){var e=template("news-item",{newses:t});$(".list-inner-group").append(e),i.page+=1}else i.loadMoreBtn.hide()}}})})},Index.prototype.listenCategorySwitchEvent=function(){var a=this;$(".list-tab").children().click(function(){var r=$(this),o=r.attr("data-category");xfzajax.get({url:"/news/list/",data:{category_id:o,p:1},success:function(n){if(200===n.code){var t=n.data,e=template("news-item",{newses:t}),i=$(".list-inner-group");i.empty(),i.append(e),a.page=2,a.category_id=o,r.addClass("active").siblings().removeClass("active"),a.loadMoreBtn.show()}}})})},Index.prototype.run=function(){this.listenLoadMoreEvent(),this.listenCategorySwitchEvent()},$(function(){var n=new Banner,t=new Index;n.run(),t.run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkJhbm5lciIsInRoaXMiLCJpbmRleCIsImJhbm5lcldpZHRoIiwiYmFubmVyR3JvdXAiLCIkIiwibGVmdEFycm93IiwicmlnaHRBcnJvdyIsImJhbm5lclVsIiwicGFnZUNvbnRyb2wiLCJsaUxpc3QiLCJjaGlsZHJlbiIsImJhbm5lckNvdW50IiwibGVuZ3RoIiwiSW5kZXgiLCJzZWxmIiwicGFnZSIsImNhdGVnb3J5X2lkIiwibG9hZE1vcmVCdG4iLCJwcm90b3R5cGUiLCJpbml0QmFubmVyIiwiZmlyc3RCYW5uZXIiLCJlcSIsImNsb25lIiwibGFzdEJhbm5lciIsImFwcGVuZCIsInByZXBlbmQiLCJjc3MiLCJ3aWR0aCIsImxlZnQiLCJpbml0UGFnZUNvbnRyb2wiLCJpIiwiY2lyY2xlIiwiYWRkQ2xhc3MiLCJ0b2dnbGVBcnJvdyIsImlzU2hvdyIsInNob3ciLCJoaWRlIiwiYW5pbWF0ZSIsInN0b3AiLCJzaWJsaW5ncyIsInJlbW92ZUNsYXNzIiwibG9vcCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJsaXN0ZW5BcnJvd0NsaWNrIiwiY2xpY2siLCJsaXN0ZW5CYW5uZXJIb3ZlciIsImhvdmVyIiwiY2xlYXJJbnRlcnZhbCIsImxpc3RlblBhZ2VDb250cm9sIiwiZWFjaCIsIm9iaiIsInJ1biIsImxpc3RlbkxvYWRNb3JlRXZlbnQiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwiZGF0YSIsInAiLCJzdWNjZXNzIiwicmVzdWx0IiwibmV3c2VzIiwidHBsIiwidGVtcGxhdGUiLCJsaXN0ZW5DYXRlZ29yeVN3aXRjaEV2ZW50IiwibGkiLCJhdHRyIiwibmV3c0xpc3RHcm91cCIsImVtcHR5IiwiYmFubmVyIl0sIm1hcHBpbmdzIjoiQUFHQSxTQUFTQSxTQUNMQyxLQUFLQyxNQUFRLEVBQ2JELEtBQUtFLFlBQWMsSUFFbkJGLEtBQUtHLFlBQWNDLEVBQUUsaUJBQ3JCSixLQUFLSyxVQUFZRCxFQUFFLGVBQ25CSixLQUFL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QU1DLFNBQVMsWUFBYSxDQUFDRixPQUFVQSxJQUN2Q00sRUFBZ0IvRCxFQUFFLHFCQUV0QitELEVBQWNDLFFBRWRELEVBQWMzQyxPQUFPc0MsR0FDckJoRCxFQUFLQyxLQUFPLEVBQ1pELEVBQUtFLFlBQWNBLEVBRW5CaUQsRUFBR2pDLFNBQVMsVUFBVU8sV0FBV0MsWUFBWSxVQUM3QzFCLEVBQUtHLFlBQVlrQixjQU9yQ3RCLE1BQU1LLFVBQVVrQyxJQUFNLFdBQ1BwRCxLQUNOcUQsc0JBRE1yRCxLQUVOZ0UsNkJBSVQ1RCxFQUFFLFdBQ0UsSUFBSWlFLEVBQVMsSUFBSXRFLE9BQ2JFLEVBQVEsSUFBSVksTUFDaEJ3RCxFQUFPakIsTUFDUG5ELEVBQU1tRCIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLyogV2hlbiBJIHdyb3RlIHRoaXMgQmFubmVyKCkgYWxnb3JpdGhtLCBvbmx5IEdvZCBrbmV3IHdoYXQgaXQgbWVhbi5cclxuICogTm93LCBHb2QgZG9lc24ndCBrbm93IGVpdGhlci4gKi9cclxuZnVuY3Rpb24gQmFubmVyKCkge1xyXG4gICAgdGhpcy5pbmRleCA9IDE7XHJcbiAgICB0aGlzLmJhbm5lcldpZHRoID0gNzk4O1xyXG5cclxuICAgIHRoaXMuYmFubmVyR3JvdXAgPSAkKFwiI2Jhbm5lci1ncm91cFwiKTtcclxuICAgIHRoaXMubGVmdEFycm93ID0gJChcIi5sZWZ0LWFycm93XCIpO1xyXG4gICAgdGhpcy5yaWdodEFycm93ID0gJChcIi5yaWdodC1hcnJvd1wiKTtcclxuICAgIHRoaXMuYmFubmVyVWwgPSAkKFwiLmJhbm5lci11bFwiKTtcclxuICAgIHRoaXMucGFnZUNvbnRyb2wgPSAkKFwiLnBhZ2UtY29udHJvbFwiKTtcclxuICAgIHRoaXMubGlMaXN0ID0gdGhpcy5iYW5uZXJVbC5jaGlsZHJlbihcImxpXCIpO1xyXG4gICAgdGhpcy5iYW5uZXJDb3VudCA9IHRoaXMubGlMaXN0Lmxlbmd0aDtcclxuXHJcbn1cclxuXHJcbkJhbm5lci5wcm90b3R5cGUuaW5pdEJhbm5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIFNlbGVjdCBmaXJzdCBsaSBlbGVtZW50IGFuZCBjbG9uZSBvbmUuXHJcbiAgICB2YXIgZmlyc3RCYW5uZXIgPSBzZWxmLmxpTGlzdC5lcSgwKS5jbG9uZSgpO1xyXG4gICAgLy8gU2VsZWN0IGxhc3QgbGkgZWxlbWVudCBhbmQgY2xvbmUgb25lLlxyXG4gICAgdmFyIGxhc3RCYW5uZXIgPSBzZWxmLmxpTGlzdC5lcShzZWxmLmJhbm5lckNvdW50LTEpLmNsb25lKCk7XHJcbiAgICAvLyBBZGQgZmlyc3QgYmFubmVyIHRvIHRoZSBlbmQuXHJcbiAgICBzZWxmLmJhbm5lclVsLmFwcGVuZChmaXJzdEJhbm5lcik7XHJcbiAgICAvLyBBZGQgbGFzdCBiYW5uZXIgdG8gdGhlIGJlZ2lubmluZy5cclxuICAgIHNlbGYuYmFubmVyVWwucHJlcGVuZChsYXN0QmFubmVyKTtcclxuICAgIC8vIEV4dGVuZCBiYW5uZXIgd2lkdGguXHJcbiAgICBzZWxmLmJhbm5lclVsLmNzcyh7XCJ3aWR0aFwiOiBzZWxmLmJhbm5lcldpZHRoKihzZWxmLmJhbm5lckNvdW50KzIpLCBcImxlZnRcIjogLXNlbGYuYmFubmVyV2lkdGh9KTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuaW5pdFBhZ2VDb250cm9sID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZm9yICh2YXIgaT0wOyBpPHNlbGYuYmFubmVyQ291bnQ7IGkrKykge1xyXG4gICAgICAgIC8vIEFkZCBsaSBlbGVtZW50LlxyXG4gICAgICAgIHZhciBjaXJjbGUgPSAkKFwiPGxpPjwvbGk+XCIpO1xyXG4gICAgICAgIHNlbGYucGFnZUNvbnRyb2wuYXBwZW5kKGNpcmNsZSk7XHJcbiAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgY2lyY2xlLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY3NzKHtcIndpZHRoXCI6IHNlbGYuYmFubmVyQ291bnQqKDEyKzE2KX0pO1xyXG4gICAgfVxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS50b2dnbGVBcnJvdyA9IGZ1bmN0aW9uIChpc1Nob3cpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGlmIChpc1Nob3cpIHtcclxuICAgICAgICBzZWxmLmxlZnRBcnJvdy5zaG93KCk7XHJcbiAgICAgICAgc2VsZi5yaWdodEFycm93LnNob3coKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc2VsZi5sZWZ0QXJyb3cuaGlkZSgpO1xyXG4gICAgICAgIHNlbGYucmlnaHRBcnJvdy5oaWRlKCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmJhbm5lclVsLnN0b3AoKS5hbmltYXRlKHtcImxlZnRcIjogLTc5OCpzZWxmLmluZGV4fSwgMTAwMCk7XHJcbiAgICB2YXIgaW5kZXggPSBzZWxmLmluZGV4O1xyXG4gICAgaWYgKGluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgaW5kZXggPSBzZWxmLmJhbm5lckNvdW50IC0gMTtcclxuICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IHNlbGYuYmFubmVyQ291bnQrMSkge1xyXG4gICAgICAgIGluZGV4ID0gMDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5kZXggPSBpbmRleCAtIDE7XHJcbiAgICB9XHJcbiAgICAvKiBBZGQgY2xhc3MgXCJhY3RpdmVcIiB0byBjbGlja2VkIGNpcmNsZVxyXG4gICAgKiAgYW5kIHJlbW92ZSBcImFjdGl2ZVwiIGZyb20gYWxsIGJyb3RoZXIgY2lyY2xlcy4gKi9cclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY2hpbGRyZW4oXCJsaVwiKS5lcShpbmRleCkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUubG9vcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHNlbGYuaW5kZXggPj0gc2VsZi5iYW5uZXJDb3VudCsxKXtcclxuICAgICAgICAgICAgc2VsZi5iYW5uZXJVbC5jc3Moe1wibGVmdFwiOiAtc2VsZi5iYW5uZXJXaWR0aH0pO1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ID0gMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuYW5pbWF0ZSgpO1xyXG4gICAgfSwgNTAwMCk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmxpc3RlbkFycm93Q2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5sZWZ0QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChzZWxmLmluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIHNlbGYuYmFubmVyVWwuY3NzKHsnbGVmdCc6IC1zZWxmLmJhbm5lckNvdW50KnNlbGYuYmFubmVyV2lkdGh9KTtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCA9IHNlbGYuYmFubmVyQ291bnQgLSAxO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXgtLTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzZWxmLnJpZ2h0QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChzZWxmLmluZGV4ID09PSBzZWxmLmJhbm5lckNvdW50KzEpIHtcclxuICAgICAgICAgICAgc2VsZi5iYW5uZXJVbC5jc3Moe1wibGVmdFwiOiAtc2VsZi5iYW5uZXJXaWR0aH0pO1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ID0gMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuYW5pbWF0ZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmxpc3RlbkJhbm5lckhvdmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5iYW5uZXJHcm91cC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyogRnVuY3Rpb25zIHRoYXQgd291bGQgYmUgZXhlY3V0ZWRcclxuICAgICAgICAqICB3aGVuIG1vdXNlIGlzIGhvdmVyZWQuICovXHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbChzZWxmLnRpbWVyKTtcclxuICAgICAgICBzZWxmLnRvZ2dsZUFycm93KHRydWUpO1xyXG4gICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8qIEZ1bmN0aW9ucyB0aGF0IHdvdWxkIGJlIGV4ZWN1dGVkXHJcbiAgICAgICAgICogd2hlbiBtb3VzZSBpcyBkcmFnZ2VkIGF3YXkuICovXHJcbiAgICAgICAgc2VsZi5sb29wKCk7XHJcbiAgICAgICAgc2VsZi50b2dnbGVBcnJvdyhmYWxzZSk7XHJcbiAgICB9KVxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5saXN0ZW5QYWdlQ29udHJvbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY2hpbGRyZW4oXCJsaVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgb2JqKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coaW5kZXgpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKG9iaik7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCI9PT09PT09PT09PT1cIik7XHJcbiAgICAgICAgJChvYmopLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCA9IGluZGV4KzE7XHJcbiAgICAgICAgICAgIHNlbGYuYW5pbWF0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuaW5pdEJhbm5lcigpO1xyXG4gICAgdGhpcy5pbml0UGFnZUNvbnRyb2woKTtcclxuICAgIHRoaXMubG9vcCgpO1xyXG4gICAgdGhpcy5saXN0ZW5CYW5uZXJIb3ZlcigpO1xyXG4gICAgdGhpcy5saXN0ZW5BcnJvd0NsaWNrKCk7XHJcbiAgICB0aGlzLmxpc3RlblBhZ2VDb250cm9sKCk7XHJcbn07XHJcblxyXG5cclxuZnVuY3Rpb24gSW5kZXggKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5wYWdlID0gMjtcclxuICAgIHNlbGYuY2F0ZWdvcnlfaWQgPSAwO1xyXG4gICAgc2VsZi5sb2FkTW9yZUJ0biA9ICQoXCIjbG9hZC1tb3JlLWJ0blwiKTtcclxufVxyXG5cclxuSW5kZXgucHJvdG90eXBlLmxpc3RlbkxvYWRNb3JlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxvYWRNb3JlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgICAgIFwidXJsXCI6IFwiL25ld3MvbGlzdC9cIixcclxuICAgICAgICAgICAgXCJkYXRhXCI6IHtcclxuICAgICAgICAgICAgICAgIFwicFwiOiBzZWxmLnBhZ2UsXHJcbiAgICAgICAgICAgICAgICBcImNhdGVnb3J5X2lkXCI6IHNlbGYuY2F0ZWdvcnlfaWRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJzdWNjZXNzXCI6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbXCJjb2RlXCJdID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdzZXMgPSByZXN1bHRbXCJkYXRhXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHBsID0gdGVtcGxhdGUoXCJuZXdzLWl0ZW1cIiwge1wibmV3c2VzXCI6IG5ld3Nlc30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdWwgPSAkKFwiLmxpc3QtaW5uZXItZ3JvdXBcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVsLmFwcGVuZCh0cGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBhZ2UgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYWRNb3JlQnRuLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuSW5kZXgucHJvdG90eXBlLmxpc3RlbkNhdGVnb3J5U3dpdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdGFiR3JvdXAgPSAkKFwiLmxpc3QtdGFiXCIpO1xyXG4gICAgdGFiR3JvdXAuY2hpbGRyZW4oKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gdGhpczogY3VycmVudGx5IHNlbGVjdGVkIHRhZ1xyXG4gICAgICAgIHZhciBsaSA9ICQodGhpcyk7XHJcbiAgICAgICAgdmFyIGNhdGVnb3J5X2lkID0gbGkuYXR0cihcImRhdGEtY2F0ZWdvcnlcIik7XHJcbiAgICAgICAgdmFyIHBhZ2UgPSAxO1xyXG5cclxuICAgICAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgICAgIFwidXJsXCI6IFwiL25ld3MvbGlzdC9cIixcclxuICAgICAgICAgICAgXCJkYXRhXCI6IHtcclxuICAgICAgICAgICAgICAgIFwiY2F0ZWdvcnlfaWRcIjogY2F0ZWdvcnlfaWQsXHJcbiAgICAgICAgICAgICAgICBcInBcIjogcGFnZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcInN1Y2Nlc3NcIjogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFtcImNvZGVcIl0gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdzZXMgPSByZXN1bHRbXCJkYXRhXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZShcIm5ld3MtaXRlbVwiLCB7XCJuZXdzZXNcIjogbmV3c2VzfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld3NMaXN0R3JvdXAgPSAkKFwiLmxpc3QtaW5uZXItZ3JvdXBcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgYWxsIGNvbnRlbnQgZmlyc3QuXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3c0xpc3RHcm91cC5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZCBuZXdzIGJ5IGNhdGVnb3J5LlxyXG4gICAgICAgICAgICAgICAgICAgIG5ld3NMaXN0R3JvdXAuYXBwZW5kKHRwbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wYWdlID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhdGVnb3J5X2lkID0gY2F0ZWdvcnlfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGNsYXNzIFwiYWN0aXZlXCIgdG8gY3VycmVudCB0YWcgYW5kIHJlbW92ZSBcImFjdGl2ZVwiIGZyb20gb3RoZXJzLlxyXG4gICAgICAgICAgICAgICAgICAgIGxpLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2FkTW9yZUJ0bi5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuSW5kZXgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuTG9hZE1vcmVFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5DYXRlZ29yeVN3aXRjaEV2ZW50KCk7XHJcbn07XHJcblxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYmFubmVyID0gbmV3IEJhbm5lcigpO1xyXG4gICAgdmFyIGluZGV4ID0gbmV3IEluZGV4KCk7XHJcbiAgICBiYW5uZXIucnVuKCk7XHJcbiAgICBpbmRleC5ydW4oKTtcclxufSk7Il19
